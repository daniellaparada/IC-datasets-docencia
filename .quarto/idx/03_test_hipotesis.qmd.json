{"title":"Test de hipótesis","markdown":{"headingText":"Test de hipótesis","containsRefs":false,"markdown":"Presentamos un ejemplo para test de hipótesis a partir de datos reales de clima y de flujo vehicular de la Ciudad Autónoma de Buenos Aires.\n\n![Cómo *MidJourney* imagina que se ilustra este problema bajo el *prompt*: */imagine a lively cityscape of Buenos Aires with the striking Obelisk towering in the center. Set the scene on a rainy day, a bustling street surrounding the Obelisk, showcasing a diverse array of cars and commuters. Divide the scene in two, with more cars in one side. Incorporate a rainy atmosphere creating puddles on the ground, and adding reflections of lights and cityscape in the wet pavement*.](./fuente/03_test_hipotesis/apertura.png){fig-align=\"center\"}\n\n\nA continuación, se muestran algunos posibles análisis para datos de flujo vehicular en CABA usando, en algunos casos, incorporando variables climáticas.\n\n```{r, message=FALSE, warning=FALSE}\n# Librerías necesarias\nrequire(ggplot2)\nrequire(tidyverse)\nrequire(ggfortify)\nrequire(plotly)\nrequire(vroom)\nrequire(effsize)\nrequire(sf)\nrequire(osmdata)\nrequire(ggmap)\nrequire(leaflet)\n```\n\n## Exploración inicial\n\n```{r, echo=FALSE, message=FALSE, results='hide', warning=FALSE}\n# importo el mapa de CABA\nbarrios_caba <- st_read(\"http://cdn.buenosaires.gob.ar/datosabiertos/datasets/barrios/barrios.geojson\") %>%\n  select(BARRIO, COMUNA)\n\n# importo datos de flujo vehicular 2019\nflujo19 <- vroom(\"./fuente/03_test_hipotesis/flujo-vehicular-por-radares-2019.csv\") %>%\n  group_by(disp_ubicacion) %>% \n  summarise(n = sum(cantidad),\n            lat = mean(lat),\n            long = mean(long)) %>%\n  drop_na() \n\npaleta <- colorQuantile(\"YlOrRd\", flujo19$n, n=6)\n```\n\n\n```{r, message=FALSE, warning=FALSE}\n# Radares\nleaflet(flujo19) %>% \n  addTiles() %>%\n  addCircleMarkers(lng= ~long, \n                   lat= ~lat,\n                   fillOpacity=0.9,\n                   radius=~100*n/(sum(n)),\n                   weight=1,\n                   color = ~paleta(n),\n                   stroke = FALSE) \n```\n\nEn el dataset reducido `flujo-vehicular.csv` se incluyen datos del flujo vehicular de los días hábiles del primer trimestre de 2019 y de 2023 para el radar RD 171 ubicado en la Autopista Lugones, altura ESMA, sentido A.\n\nEl dataset `flujo-vehicular.csv` se encuentra [acá](https://www.dropbox.com/scl/fi/4lzzhbi3avqq945wno0e2/flujo-clima.csv?rlkey=nl9m3bxm9jhfrbpjs08pcg4af&dl=0). A continuación se muestran 10 datos de dicho conjunto.\n\n```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE}\ndatos <- read_csv(\"./fuente/03_test_hipotesis/flujo-vehicular.csv\")\noptions(scipen=999)\n```\n\n```{r, message=FALSE, warning=FALSE}\nknitr::kable(datos[1:10,], caption = \"Dataset reducido, primeras 10 observaciones.\")\n```\n\nCada observación corresponde al flujo total detectado por ese radar de un día que resultó hábil tanto en 2019 como en 2023.\n\nComo puede verse en el siguiente gráfico XXX\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE}\nggplotly(ggplot(data = datos, aes(x=n19, y=n23, key=fecha)) + \n  labs(x = \"Flujo vehicular Lugones (Esma) 2019\", y= \"Flujo vehicular Lugones (Esma) 2023\") +\n  xlim(0, 140000) +\n  ylim(0, 140000) +\n  geom_point(colour = \"firebrick\") + \n  geom_abline(slope=1,intercept=0,show.legend = F,linetype=\"dashed\") +\n  theme_classic(),\n  source = \"select\", tooltip = c(\"key\"))\n```\n\nLos días 20 y 21 de febrero de 2023 corresponden a feriados de carnaval, mientras que los días 9 y 16 de enero de 2019 Removemos posibles atípicos: 9 y 16 ene 2019; 20 y 21 feb 2023.\n\n```{r echo=FALSE}\n# Removemos posibles atípicos: 9 y 16 ene 2019; 20 y 21 feb 2023\nrecambios <- c(4,7,20,21)\nflujosout <- datos[-recambios,]\n```\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\nggplotly(ggplot(data = flujosout, aes(x=n19, y=n23, key=fecha)) +\n  labs(x = \"Flujo vehicular Lugones (Esma) 2019\", y= \"Flujo vehicular Lugones (Esma) 2023\") +\n  xlim(100000, 140000) +\n  ylim(100000, 140000) +\n  geom_point(colour = \"firebrick\") + \n  geom_abline(slope=1,intercept=0,show.legend = F,linetype=\"dashed\") +\n  theme_classic(),\n  source = \"select\", tooltip = c(\"key\"))\n```\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\n# Gráfico\nfl <- data.frame(flujo = c(flujosout$n19,flujosout$n23),\n                 dia = c(flujosout$fecha,flujosout$fecha),\n                 anio = as.factor(c(rep(\"2019\", length(flujosout$n19)),\n                                    rep(\"2023\", length(flujosout$n23))))) \n\nlabs = fl$dia[c(1,8,16,24,32,40,48,56)]\n\nggplotly(ggplot(data = fl, aes(x=dia, y=flujo, color=anio, key=dia)) + \n  labs(x = \"Día (solo para lunes a viernes de ambos años)\", y= \"Flujo vehicular Lugones (Esma)\", color = \"Año\") + \n  geom_point() + \n  scale_x_discrete(breaks=seq(1,8,1),labels=labs) +\n  theme_classic(),\n  source = \"select\", tooltip = c(\"key\"))\n```\n\n## Test para diferencia de medias (primer trimestre 2019 vs 2023)\n\n```{r echo=FALSE, message=FALSE, warning=FALSE}\n# Test para diferencia de medias\nt.test(x = flujosout$n19, y = flujosout$n23, alternative = \"two.sided\",\n       mu = 0, paired = TRUE, conf.level = 0.99)\n\n# Effectsize\ncohen.d(d = flujosout$n19, f = flujosout$n23, paired = TRUE)\n```\n\n## Incorporamos datos de clima\n\n```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE}\ndatos <- read_csv(\"./fuente/03_test_hipotesis/flujo-clima.csv\")\n```\n\n```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}\nflujoclima <- datos\nggplotly(ggplot(data = filter(flujoclima), aes(x=factor(dia, level=c(\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\",\"domingo\")), \n                                      y=n, color=tipo_dia, key=prcp)) + \n  geom_point(aes(size=prcp)) +\n  labs(x = \"Días de la semana\", y= \"Flujo vehicular Lugones (Esma)\", \n       color = \"Tipo de día\", size = \"Precipitaciones\") + \n  theme_classic(),\n  source = \"select\", tooltip = c(\"key\"))\n```\n\n¿Hay diferencia en el flujo medio cuando llueve (días hábiles)?\n\n```{r message=FALSE, warning=FALSE}\n# Días de semana con lluvia: 20 datos\ndatos1 <- flujoclima %>%\n  filter(prcp>0, \n         tipo_dia == \"Lunes a viernes\")\n\n# Días de semana sin lluvia: 45 datos\ndatos2 <- flujoclima %>%\n  filter(prcp==0, \n         tipo_dia == \"Lunes a viernes\")\n\nboxplot(datos1$n,datos2$n, col=c(\"firebrick\",\"springgreen4\"),\n        names=c(\"Lluvia\", \"Sin lluvia\"))\n```\n\nTest para diferencia de medias\n\n```{r message=FALSE, warning=FALSE}\n# Test para diferencia de medias\nt.test(x = datos1$n, y = datos2$n, alternative = \"two.sided\",\n       mu = 0, paired = FALSE, conf.level = 0.95)\n```\n\n¿Hay diferencia en el flujo medio entre lunes y miércoles?\n\n```{r message=FALSE, warning=FALSE}\n# Días de semana con lluvia: 13 datos\ndatos1 <- flujoclima %>%\n  filter(dia == \"lunes\")\n\n# Días de semana sin lluvia: 13 datos\ndatos2 <- flujoclima %>%\n  filter(dia == \"miércoles\")\n\nboxplot(datos1$n,datos2$n, col=c(\"firebrick\",\"springgreen4\"),\n        names=c(\"Lunes\", \"Miércoles\"))\n```\n\nTest para diferencia de medias\n\n```{r message=FALSE, warning=FALSE}\nt.test(x = datos1$n, y = datos2$n, alternative = \"two.sided\",\n       mu = 0, paired = FALSE, conf.level = 0.95)\n```\n\n# Acerca de los datos\n\nA continuación, se detallan aspectos de los datasets que conformaron el *dataset* reducido para el desarrollo del ejemplo, a la vez que se incluyen las fuentes de los datos y el código utilizado para pre-procesarlo con la sintaxis de `tidyverse`. De esta forma, puede fácilmente replicarse y/o adaptarse si así se lo desea.\n\nTambién se incluye el enlace de descarga al dataset reducido, `clima-flujo.csv`, con el que se desarrolló el ejemplo.\n\n## Sobre el *dataset* de clima\n\nLos datos de este ejemplo corresponden a datos de clima del año 2022 tomados de la base de datos meteorológicos y climáticos de MeteoStat [(disponibles acá)](https://meteostat.net/es/station/87582?t=2022-01-01/2022-12-31). En particular, se consideran los datos de la estación meteorológica de Aeroparque (ID 87582), desde XXX, y un conjunto reducido de variables.\n\n```{r, message=FALSE, warning=FALSE, eval=FALSE, echo=TRUE}\nclima <- read_csv(\"./fuente/02_regresion_multiple/registro_tiempo_aeroparque.csv\") %>% \n  select(c(1:5,7:8,10))\n```\n\n## Sobre el *dataset* de flujo vehocular\n\nLos datos de este ejemplo corresponden a datos de uso del sistema Ecobici de la Ciudad de Buenos Aires [(disponibles acá)](https://data.buenosaires.gob.ar/dataset/bicicletas-publicas). En particular, se consideran los datos del año 2022 correspondientes a viajes de entre 5 minutos y 1 hora de duración.\n\nEcobici es el sistema de transporte público de bicicletas de la Ciudad de Buenos Aires, que tiene estaciones automáticas con bicicletas a disposición las 24 horas, todos los días del año. El sistema es gratuito para todas las personas residentes del país de lunes a viernes (días hábiles) con hasta cuatro viajes de 30 minutos cada uno. Sin embargo, si se utiliza por un tiempo mayor que el indicado o durante los fines de semana, existen diferentes pases con variados costos. A modo de referencia, el pase que habilita a hacer 6 viajes diarios de hasta 60 minutos cada uno cualquier día de la semana tiene un costo de \\$1.785 (junio 2023).\n\n```{r, message=FALSE, warning=FALSE, eval=FALSE, echo=TRUE}\n\n```\n\n## *Dataset* pre-procesado: `clima-flujo.csv`\n\nPara reducir los datos al estudio de interés, se crea un *dataset* conjunto, `clima-flujo.csv`, a partir de los datos de clima y de XXX, en el que se dispone de las siguientes variables.\n\n-   `fecha`: fecha, en el formato año-mes-día.\n-   `n`: cantidad de registros de uso del sistema EcoBici en la fecha indicada.\n-   `tmed`: temperatura media (°C) registrada en esa fecha.\n-   `tmin`: temperatura mínima (°C) registrada en esa fecha.\n-   `tmax`: temperatura máxima (°C) registrada en esa fecha.\n-   `prcp`: precipitaciones (mm) registrada en esa fecha.\n-   `dia`: día de la semana de la fecha indicada.\n-   `tipo_dia`: tipo de día (Fin de semana o Lunes a viernes) de la fecha indicada.\n-   `lluvia`: condición de lluvia (Llueve: `prcp`\\>0, No llueve: `prcp`=0) de la fecha indicada.\n\n```{r, message=FALSE, warning=FALSE, eval=FALSE, echo=TRUE}\n\n```\n\n# Librerías\n\nLas librerías usadas para el desarrollo de este ejemplo, así como la información de la sesión de `R`, se muestran en el código que sigue.\n\n```{r, message=FALSE, warning=FALSE, eval=FALSE, echo=TRUE}\nrequire(tidyverse)\nrequire(ggfortify)\nrequire(plotly)\nrequire(kableExtra)\nrequire(knitr)\n```\n\n```{r message=FALSE, warning=FALSE}\nsessionInfo()\n```\n\n# Referencias\n\n-   MeteoStat [(info disponible acá](https://meteostat.net) [y datos disponibles acá.)](https://meteostat.net/es/station/87582?t=2022-01-01/2022-12-31)\n\n-   Sistema Ecobici de la Ciudad Autónoma de Buenos Aires [(info disponible acá](https://baecobici.com.ar/#/es/inicio) [y datos disponibles acá.)](https://data.buenosaires.gob.ar/dataset/bicicletas-publicas)\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":true,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"03_test_hipotesis.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.3.433","bibliography":["references.bib"],"code-summary":"Ver código","editor":"visual","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}